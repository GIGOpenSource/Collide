# è¯„è®ºæ¨¡å—å­—æ®µå¯¹æ¯”åˆ†æ

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£å¯¹æ¯”åˆ†æäº† `comment-simple.sql` ä¸­çš„è¡¨ç»“æ„å­—æ®µä¸ `Comment.java` å®ä½“ç±»å­—æ®µçš„ä¸€è‡´æ€§ã€‚

## ğŸ” å­—æ®µå¯¹æ¯”ç»“æœ

### âœ… å®Œå…¨åŒ¹é…çš„å­—æ®µ

| SQLå­—æ®µå | Javaå­—æ®µå | ç±»å‹ | è¯´æ˜ |
|-----------|------------|------|------|
| `id` | `id` | BIGINT/Long | è¯„è®ºIDï¼Œä¸»é”® |
| `comment_type` | `commentType` | VARCHAR(20)/String | è¯„è®ºç±»å‹ï¼šCONTENTã€DYNAMIC |
| `target_id` | `targetId` | BIGINT/Long | ç›®æ ‡å¯¹è±¡ID |
| `parent_comment_id` | `parentCommentId` | BIGINT/Long | çˆ¶è¯„è®ºIDï¼Œ0è¡¨ç¤ºæ ¹è¯„è®º |
| `content` | `content` | TEXT/String | è¯„è®ºå†…å®¹ |
| `user_id` | `userId` | BIGINT/Long | è¯„è®ºç”¨æˆ·ID |
| `user_nickname` | `userNickname` | VARCHAR(100)/String | ç”¨æˆ·æ˜µç§°ï¼ˆå†—ä½™ï¼‰ |
| `user_avatar` | `userAvatar` | VARCHAR(500)/String | ç”¨æˆ·å¤´åƒï¼ˆå†—ä½™ï¼‰ |
| `reply_to_user_id` | `replyToUserId` | BIGINT/Long | å›å¤ç›®æ ‡ç”¨æˆ·ID |
| `reply_to_user_nickname` | `replyToUserNickname` | VARCHAR(100)/String | å›å¤ç›®æ ‡ç”¨æˆ·æ˜µç§°ï¼ˆå†—ä½™ï¼‰ |
| `reply_to_user_avatar` | `replyToUserAvatar` | VARCHAR(500)/String | å›å¤ç›®æ ‡ç”¨æˆ·å¤´åƒï¼ˆå†—ä½™ï¼‰ |
| `status` | `status` | VARCHAR(20)/String | çŠ¶æ€ï¼šNORMALã€HIDDENã€DELETED |
| `like_count` | `likeCount` | INT/Integer | ç‚¹èµæ•°ï¼ˆå†—ä½™ç»Ÿè®¡ï¼‰ |
| `reply_count` | `replyCount` | INT/Integer | å›å¤æ•°ï¼ˆå†—ä½™ç»Ÿè®¡ï¼‰ |
| `create_time` | `createTime` | TIMESTAMP/LocalDateTime | åˆ›å»ºæ—¶é—´ |
| `update_time` | `updateTime` | TIMESTAMP/LocalDateTime | æ›´æ–°æ—¶é—´ |

### ğŸ“Š å­—æ®µç»Ÿè®¡

| é¡¹ç›® | æ•°é‡ | è¯´æ˜ |
|------|------|------|
| **SQLè¡¨å­—æ®µ** | 16ä¸ª | åŒ…å«ä¸»é”®ã€ä¸šåŠ¡å­—æ®µã€å†—ä½™å­—æ®µã€æ—¶é—´å­—æ®µ |
| **Javaå®ä½“å­—æ®µ** | 16ä¸ª | å®Œå…¨å¯¹åº”SQLè¡¨å­—æ®µ |
| **åŒ¹é…å­—æ®µ** | 16ä¸ª | 100%åŒ¹é… |
| **ä¸åŒ¹é…å­—æ®µ** | 0ä¸ª | æ— å·®å¼‚ |

### ğŸ¯ å­—æ®µæ˜ å°„åˆ†æ

#### 1. ä¸»é”®å­—æ®µ
- **SQL**: `id BIGINT NOT NULL AUTO_INCREMENT`
- **Java**: `@TableId(value = "id", type = IdType.AUTO) private Long id`
- **çŠ¶æ€**: âœ… å®Œå…¨åŒ¹é…

#### 2. ä¸šåŠ¡å­—æ®µ
- **è¯„è®ºç±»å‹**: `comment_type` â†” `commentType`
- **ç›®æ ‡å¯¹è±¡**: `target_id` â†” `targetId`
- **çˆ¶è¯„è®º**: `parent_comment_id` â†” `parentCommentId`
- **è¯„è®ºå†…å®¹**: `content` â†” `content`
- **çŠ¶æ€**: `status` â†” `status`

#### 3. ç”¨æˆ·ä¿¡æ¯å­—æ®µï¼ˆå†—ä½™è®¾è®¡ï¼‰
- **è¯„è®ºç”¨æˆ·**: `user_id`, `user_nickname`, `user_avatar`
- **å›å¤ç”¨æˆ·**: `reply_to_user_id`, `reply_to_user_nickname`, `reply_to_user_avatar`

#### 4. ç»Ÿè®¡å­—æ®µï¼ˆå†—ä½™è®¾è®¡ï¼‰
- **ç‚¹èµæ•°**: `like_count` â†” `likeCount`
- **å›å¤æ•°**: `reply_count` â†” `replyCount`

#### 5. æ—¶é—´å­—æ®µ
- **åˆ›å»ºæ—¶é—´**: `create_time` â†” `createTime`
- **æ›´æ–°æ—¶é—´**: `update_time` â†” `updateTime`

### ğŸ”§ æ‰©å±•å­—æ®µï¼ˆä¸æ˜ å°„åˆ°æ•°æ®åº“ï¼‰

Javaå®ä½“ç±»è¿˜åŒ…å«ä»¥ä¸‹æ‰©å±•å­—æ®µï¼Œç”¨äºä¸šåŠ¡é€»è¾‘å¤„ç†ï¼š

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | æ˜ å°„çŠ¶æ€ |
|--------|------|------|----------|
| `children` | `List<Comment>` | å­è¯„è®ºåˆ—è¡¨ï¼ˆæ ‘å½¢ç»“æ„ï¼‰ | `@TableField(exist = false)` |
| `level` | `Integer` | è¯„è®ºå±‚çº§æ·±åº¦ | `@TableField(exist = false)` |

## ğŸ“‹ ç´¢å¼•åˆ†æ

### SQLè¡¨ç´¢å¼•
```sql
PRIMARY KEY (`id`),
KEY `idx_target_id` (`target_id`),
KEY `idx_user_id` (`user_id`),
KEY `idx_parent_comment_id` (`parent_comment_id`),
KEY `idx_status` (`status`)
```

### ç´¢å¼•ç”¨é€”åˆ†æ
1. **ä¸»é”®ç´¢å¼•**: `id` - å”¯ä¸€æ ‡è¯†ï¼Œå¿«é€ŸæŸ¥è¯¢
2. **ç›®æ ‡å¯¹è±¡ç´¢å¼•**: `target_id` - æŸ¥è¯¢ç‰¹å®šå¯¹è±¡çš„è¯„è®º
3. **ç”¨æˆ·ç´¢å¼•**: `user_id` - æŸ¥è¯¢ç”¨æˆ·çš„è¯„è®º
4. **çˆ¶è¯„è®ºç´¢å¼•**: `parent_comment_id` - æŸ¥è¯¢å›å¤è¯„è®º
5. **çŠ¶æ€ç´¢å¼•**: `status` - æŒ‰çŠ¶æ€ç­›é€‰è¯„è®º

## ğŸ¯ è®¾è®¡ç‰¹ç‚¹

### 1. å†—ä½™å­—æ®µè®¾è®¡
- **ç”¨æˆ·ä¿¡æ¯å†—ä½™**: é¿å…è¿è¡¨æŸ¥è¯¢ï¼Œæå‡æ€§èƒ½
- **ç»Ÿè®¡å­—æ®µå†—ä½™**: å‡å°‘å®æ—¶è®¡ç®—ï¼Œæå‡æŸ¥è¯¢æ•ˆç‡

### 2. å¤šçº§è¯„è®ºæ”¯æŒ
- **çˆ¶å­å…³ç³»**: `parent_comment_id` æ”¯æŒæ— é™å±‚çº§
- **æ ‘å½¢ç»“æ„**: Javaå®ä½“æ”¯æŒ `children` å­—æ®µæ„å»ºæ ‘å½¢

### 3. çŠ¶æ€ç®¡ç†
- **é€»è¾‘åˆ é™¤**: ä½¿ç”¨ `status` å­—æ®µè€Œéç‰©ç†åˆ é™¤
- **çŠ¶æ€æµè½¬**: NORMAL â†’ HIDDEN â†’ DELETED

### 4. æ—¶é—´ç®¡ç†
- **åˆ›å»ºæ—¶é—´**: è‡ªåŠ¨è®¾ç½®ï¼Œä¸å¯ä¿®æ”¹
- **æ›´æ–°æ—¶é—´**: è‡ªåŠ¨æ›´æ–°ï¼Œè®°å½•æœ€åä¿®æ”¹æ—¶é—´

## âœ… ç»“è®º

**å­—æ®µä¸€è‡´æ€§**: 100% åŒ¹é… âœ…

- **SQLè¡¨å­—æ®µ**: 16ä¸ª
- **Javaå®ä½“å­—æ®µ**: 16ä¸ªï¼ˆæ˜ å°„å­—æ®µï¼‰+ 2ä¸ªï¼ˆæ‰©å±•å­—æ®µï¼‰
- **åŒ¹é…ç‡**: 100%
- **å·®å¼‚**: æ— 

### ä¼˜åŠ¿
1. **å®Œå…¨ä¸€è‡´**: SQLè¡¨ç»“æ„ä¸Javaå®ä½“ç±»å®Œå…¨å¯¹åº”
2. **å‘½åè§„èŒƒ**: ä¸‹åˆ’çº¿å‘½åè½¬é©¼å³°å‘½åï¼Œç¬¦åˆJavaè§„èŒƒ
3. **ç±»å‹åŒ¹é…**: æ•°æ®ç±»å‹å®Œå…¨å¯¹åº”
4. **æ³¨é‡Šå®Œæ•´**: å­—æ®µæ³¨é‡Šæ¸…æ™°æ˜ç¡®

### å»ºè®®
1. **ä¿æŒåŒæ­¥**: åç»­ä¿®æ”¹æ—¶ç¡®ä¿SQLå’ŒJavaä¿æŒåŒæ­¥
2. **æ–‡æ¡£ç»´æŠ¤**: åŠæ—¶æ›´æ–°å­—æ®µå˜æ›´æ–‡æ¡£
3. **æµ‹è¯•éªŒè¯**: å®šæœŸéªŒè¯å­—æ®µæ˜ å°„çš„æ­£ç¡®æ€§

## ğŸ“ æ€»ç»“

è¯„è®ºæ¨¡å—çš„å­—æ®µè®¾è®¡éå¸¸è§„èŒƒï¼ŒSQLè¡¨ç»“æ„ä¸Javaå®ä½“ç±»å®Œå…¨ä¸€è‡´ï¼Œä½“ç°äº†è‰¯å¥½çš„è®¾è®¡è§„èŒƒï¼š

- âœ… **å­—æ®µå®Œæ•´æ€§**: æ‰€æœ‰å¿…è¦å­—æ®µéƒ½å·²åŒ…å«
- âœ… **å‘½åè§„èŒƒ**: ç¬¦åˆæ•°æ®åº“å’ŒJavaçš„å‘½åè§„èŒƒ
- âœ… **ç±»å‹åŒ¹é…**: æ•°æ®ç±»å‹å®Œå…¨å¯¹åº”
- âœ… **æ³¨é‡Šå®Œæ•´**: å­—æ®µè¯´æ˜æ¸…æ™°æ˜ç¡®
- âœ… **æ‰©å±•æ€§**: æ”¯æŒä¸šåŠ¡æ‰©å±•éœ€æ±‚

è¿™ç§è®¾è®¡ä¸ºåç»­çš„å¼€å‘å·¥ä½œå¥ å®šäº†è‰¯å¥½çš„åŸºç¡€ã€‚ 